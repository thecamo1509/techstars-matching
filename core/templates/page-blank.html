{% load static %}
<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}


  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="apple-touch-icon" sizes="76x76" href="{% static 'assets/img/apple-icon.png' %}">
  <link rel="icon" type="image/png"          href="{% static 'assets/img/techstarsfavicon.png'%}">

  <link href="{% static 'assets/css/nucleo-icons.css' %}" rel="stylesheet" />
  <!-- CSS Files -->
  <link href="{% static 'assets/css/black-dashboard.css' %}" rel="stylesheet" />

  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">

{% endblock stylesheets %}

{% block content %}
<style>
    .mainrow {
        margin: 2em;
    }

    /*Profile Card 3*/
  .profile-card-4 {
      font-family: 'Open Sans', Arial, sans-serif;
      position: relative;
      float: left;
      overflow: hidden;
      width: 100%;
      text-align: center;
      height:50em;
      border:none;
    }
    .profile-card-4 .background-block {
        float: left;
        width: 100%;
        height: 200px;
        overflow: hidden;
    }
    .profile-card-4 .background-block .background {
      width:100%;
      vertical-align: top;
      opacity: 0.9;
      transform: scale(2.8);
    }
    .profile-card-4 .card-content {
      width: 100%;
      padding: 15px 25px;
      color:#232323;
      float:left;
      background:#181825;
      height:50%;
      border-radius:0 0 5px 5px;
      position: relative;
      z-index: 1;
    }
    .profile-card-4 .card-content::before {
        content: '';
        background: #181825;
        width: 120%;
        height: 100%;
        left: 11px;
        bottom: 51px;
        position: absolute;
        z-index: -1;
        transform: rotate(-13deg);
    }
    .profile-card-4 .profile {
      border-radius: 50%;
      position: absolute;
      bottom: 72%;
      left: 50%;
      max-width: 100px;
      opacity: 1;
      box-shadow: 3px 3px 20px rgba(0, 0, 0, 0.5);
      border: 2px solid rgba(255, 255, 255, 1);
      -webkit-transform: translate(-50%, 0%);
      transform: translate(-50%, 0%);
      z-index:2;
    }
    .profile-card-4 h3 {
      margin: 0 0 5px;
      font-weight: 600;
      font-size:20px;
    }
    .profile-card-4 h3 small {
      display: block;
      font-size: 15px;
    }
    .profile-card-4 i {
      display: inline-block;
        font-size: 16px;
        color: white;
        text-align: center;
        border: 1px solid #39C463;
        width: 30px;
        height: 30px;
        line-height: 30px;
        border-radius: 50%;
        margin:0 5px;
    }
    .profile-card-4 .icon-block{
        float:left;
        width:100%;
        margin-top:15px;
    }
    .profile-card-4 .icon-block a{
        text-decoration:none;
    }
    .profile-card-4 i:hover {
      background-color: #5baaff !important;
      color: white;
      text-decoration:none;
    }

    .profile-card-4 .boton{
      position: relative;
      display: inline-block;
      font-weight: 600;
      color: white;
      text-align: center;
      vertical-align: middle;
      user-select: none;
      background: rgba(255,255,255, 0.3);
      border: 1px solid transparent;
      padding: 10px 10px;
      font-size: 0.775rem;
      line-height: 1.35em;
      border-radius: 0.25rem;
      transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }

    .profile-card-4 .boton:hover {
      background-color: #39C463;
    }

    .customrow {
      position: relative;
      flex-wrap: nowrap;
      overflow-x: auto !important;
    }

    .successbtninstructions {
      position=absolute;
      bottom: -0.2em;
      background: rgba(0,0,0,0);
      border: 2px solid #39C463;
    }

    .successbtninstructions:hover {
      position=absolute;
      background: rgba(0,0,0,0) !important;
      border: 2px solid #39C463;
      cursor: auto;
    }

    .successbtn {
      position=absolute;
      bottom: -0.2em;
      background-image: linear-gradient(to bottom left, #39C463, #136c2e, #39C463);
    }

    .successbtn:hover {
      position=absolute;
      bottom: -0.2em;
      background-image: linear-gradient(to bottom left, #49ff80, #23ad4d, #49ff80) !important;
    }

    .warningbtn {
      position=absolute;
      bottom: -0.2em;
      background-image: linear-gradient(to bottom left, #ffc107, #c19205, #ffc107);
    }

    .warningbtninstructions {
      position=absolute;
      bottom: -0.2em;
      background: rgba(0,0,0,0);
      border: 2px solid #ffc107;
    }

    .warningbtninstructions:hover {
      position=absolute;
      background: rgba(0,0,0,0) !important;
      border: 2px solid #ffc107;
      cursor: auto;
    }

    .warningbtn:hover {
      position=absolute;
      bottom: -0.2em;
      background-image: linear-gradient(to bottom left, #ffe800, #cc9c10, #ffe800) !important;
    }

    .dangerbtn {
      position=absolute;
      bottom: -0.2em;
      background-image: linear-gradient(to bottom left, #dc3545, #c82333, #dc3545);
    }

    .dangerbtninstructions {
      position=absolute;
      bottom: -0.2em;
      background: rgba(0,0,0,0);
      border: 2px solid #dc3545;
    }

    .dangerbtninstructions:hover {
      position=absolute;
      background: rgba(0,0,0,0) !important;
      border: 2px solid #dc3545;
      cursor: auto;
    }

    .dangerbtn:hover {
      position=absolute;
      bottom: -0.2em;
      background-image: linear-gradient(to bottom left, #ff3e51, #da1327, #ff3e51) !important;
    }

    .undo {
        background: #007bff;
        border: 1px solid #007bff;
    }

    .undo:hover {
      background: #5baaff !important;
      border: 1px solid #007bff;
    }

    .range {
    display: table;
    position: relative;
    height: 25px;
    background-color: rgba(245, 245, 245, 0.2);
    border-radius: 4px;
    -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
    cursor: pointer;
}

.range input[type="range"] {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    -ms-appearance: none !important;
    -o-appearance: none !important;
    appearance: none !important;

    display: table-cell;
    width: 100%;
    background-color: transparent;
    height: 25px;
    cursor: pointer;
}
.range input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    -ms-appearance: none !important;
    -o-appearance: none !important;
    appearance: none !important;

    width: 11px;
    height: 25px;
    color: rgb(255, 255, 255);
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0px;
    background-color: rgb(153, 153, 153);
}

.range input[type="range"]::-moz-slider-thumb {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    -ms-appearance: none !important;
    -o-appearance: none !important;
    appearance: none !important;

    width: 11px;
    height: 25px;
    color: rgb(255, 255, 255);
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0px;
    background-color: rgb(153, 153, 153);
}

.range output {
    display: table-cell;
    padding: 3px 5px 2px;
    min-width: 40px;
    color: rgb(255, 255, 255);
    background-color: rgb(153, 153, 153);
    text-align: center;
    text-decoration: none;
    border-radius: 4px;
    border-bottom-left-radius: 0;
    border-top-left-radius: 0;
    width: 1%;
    white-space: nowrap;
    vertical-align: middle;

    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    -ms-transition: all 0.5s ease;
    transition: all 0.5s ease;

    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: -moz-none;
    -o-user-select: none;
    user-select: none;
}
.range input[type="range"] {
    outline: none;
}

.range.range-success input[type="range"]::-webkit-slider-thumb {
    background-color: rgb(92, 184, 92);
}
.range.range-success input[type="range"]::-moz-slider-thumb {
    background-color: rgb(92, 184, 92);
}
.range.range-success output {
    background-color: rgb(92, 184, 92);
}
.range.range-success input[type="range"] {
    outline-color: rgb(92, 184, 92);
}
</style>
    <div>
        <div class="card text-center">
            <h2 class="card-title mt-2">{{mentor.name}}</h2>
            <div class="left">
                <h4>User Guide</h4>
                <span class="btn btn-sm successbtninstructions">Want: <h5>you would want to work with them as a Lead Mentor</h5></span>
                <span class="btn btn-sm warningbtninstructions">Willing: <h5>you would be willing to work with them as a Lead Mentor</h5></span>
                <span class="btn btn-sm dangerbtninstructions">Won't: <h5>you do not want/ won't work with them as a Lead Mentor.</h5></span>
            </div>
            <div class="row mainrow">
            {% for appointment in appointments %}
                <div class="col-lg-2">
                    <div class="card profile-card-4">
                        <div class="background-block">
                        <img src="https://i.imgur.com/17eCqi9.png" alt="profile-sample1" class="background"/>
                        </div>
                        <div class="profile-thumb-block">
                            <img src="{{appointment.startup.startupPic}}" alt="profile-image" class="profile"/>
                        </div>
                        <div class="card-content">
                            <h3>{{appointment.startup.companyName}}</h3>
                            {% if appointment.mentorResponse %}
                                <h3 style="display: block;" id="responsemessage{{appointment.id}}"><p><b>Thank you for your response</b></p><span class="btn btn-sm undo" onclick="undoresponse({{appointment.id}})">Undo</span></h3>
                                <div id="appointment{{appointment.id}}" style="display: none">
                                    <button class="btn btn-sm successbtn" onClick="appendresponses({{appointment.id}}, 'want')">Want</button>
                                    <button class="btn btn-sm warningbtn" onClick="appendresponses({{appointment.id}}, 'willing')">Willing</button>
                                    <button class="btn btn-sm dangerbtn" onClick="appendresponses({{appointment.id}}, 'wont')">Won't</button>
                                </div>
                            {% else %}
                                <h3 style="display: none;" id="responsemessage{{appointment.id}}"><p><b>Thank you for your response</b></p><span class="btn btn-sm undo" onclick="undoresponse({{appointment.id}})">Undo</span></h3>
                                <div id="appointment{{appointment.id}}">
                                    <button class="btn btn-sm successbtn" onClick="appendresponses({{appointment.id}}, 'want')">Want</button>
                                    <button class="btn btn-sm warningbtn" onClick="appendresponses({{appointment.id}}, 'willing')">Willing</button>
                                    <button class="btn btn-sm dangerbtn" onClick="appendresponses({{appointment.id}}, 'wont')">Won't</button>
                                </div>
                            {% endif %}
                            <div class="row">
                              <div class="col">
                                <label class="mt-2">Slide to rank</label>
                                <div class="range range-success">
                                  <input type="range" name="range" min="1" max="5" value="3" onchange="range.value=value">
                                  <output id="range">5</output>
                                </div>
                              </div>
                            </div>

                            <div class="form-group" style="margin: 1em;">
                                <label>Please explain: (optional)</label>
                                <textarea rows="4" cols="80" class="form-control" placeholder="Type here"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
            </div>
            <div class="text-center mb-5">
                <button type="button" class="btn btn-primary" style="margin: 0 auto;" id="submitbutton" onclick="submit()">Submit</button>
            </div>
            </div>
        </div>
    </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>
    var responses = []
    var mentorstotal = {{appointments.count}}

    function appendresponses (id, response) {
        if(responses.includes(responses.find(object => object.id === id))){
            elementtoupdate = responses.find(object => object.id === id)
            elementtoupdate.mentorresponse = response
        } else {
            responses.push(
            {'id': id, 'mentorresponse': response}
            )
        }
      buttons = document.getElementById("appointment" + id);
      buttons.style.display = 'none';
      selectedresponse = document.getElementById("responsemessage" + id);
      selectedresponse.style.display = 'block';
      if (responses.length === mentorstotal) {
        mybutton = document.getElementById("submitbutton")
        mybutton.classList.remove("disabled");
      }
    }

    function undoresponse(id) {
        myid = id;
        console.log(responses)
        var objecttoupdate = {}
        if(responses.length !== 0){
            if(responses.includes(responses.find(object => object.id === id))){
                objecttoupdate = responses.find(object => object.id === id)
                objecttoupdate.mentorresponse = ''
            } else {
              objecttoupdate = {'id': id, 'mentorresponse': ''}
              responses.push(objecttoupdate)
            }
        } else {
            objecttoupdate = {'id': id, 'mentorresponse': ''}
            responses.push(objecttoupdate)
        }
        buttons = document.getElementById("appointment" + id);
        buttons.style.display = 'block'
        selectedresponse = document.getElementById("responsemessage" + id);
        selectedresponse.style.display = 'none'
        console.log(responses)
    }

    function submit (answers=responses) {
        fetch('/mentorresponses', {
          method: 'POST',
          headers:{'content-type': 'application/json'},
          body: JSON.stringify(answers)
        })
        .then(function(response) {
          if(response.ok) {
              return response.text()
          } else {
              throw "Error en la llamada Ajax";
          }

        })
        .then(function(texto) {
          console.log(texto);
        })
        .catch(function(err) {
          console.log(err);
        });
    }
</script>

{% endblock javascripts %}
